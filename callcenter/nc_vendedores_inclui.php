<?
session_start();
session_register("session");
include "cc_libcallcenter.php";
if (!isset($session)) {header ("Location:".HTTPHOST.DOCROOT."cc_login.php"); exit;}
//showvars();
include "funcoes/NCFuncoes.php";
include "mk_funcoes.php";
require_once($_SERVER["DOCUMENT_ROOT"]."/libs/lang/tradutor.php");
$objTradutor = new Tradutor($session["idioma"], "nc");
require_once($_SERVER["DOCUMENT_ROOT"]."/libs/func/AJAXFunc.php");
arrayr_map_globals("addslashes");

if ($volta_discador_modelo) {
  $discador_modelo = $volta_discador_modelo;
}

if(!$volta_repre) {
  $volta_repre = $repre;
}

carregaParam($discador_modelo."A", $volta_repre);
carregaParam($discador_modelo."B", $volta_repre);

$connect    = Conecta($param_host, $param_user, $param_senha, $param_bd);
$conexaoGen = new Conexao($param_host, $param_bd, $param_user, $param_senha);

if (!$acao) {
  $acao="Incluir";
}


$campo_data_nasc = ValorClasse("NC".substr($discador_modelo, 2, 2)."P", "CAMPO_DATA_NASC" , DefineRepre($volta_repre));
$usa_cpf    = ValorClasse("NC".substr($discador_modelo, 2, 2)."P","USA_CAMPO_CPF",DefineRepre($volta_repre));

//print $param_nro_nc."****".$volta_repre;

$usa_campo_cod_adabas  = ValorClasse("NC".$param_nro_nc."P", "USA_CAMPO_COD_ADABAS" , $volta_repre);
$parametros_cod_adabas = ValorClasse("NC".$param_nro_nc."P", "PARAMETROS_COD_ADABAS", $volta_repre);

$usa_campo_vendedor_cidade  = ValorClasse("NC".$param_nro_nc."P", "USA_CAMPO_VEND_CIDADE" , $volta_repre);
$parametros_vendedor_cidade = ValorClasse("NC".$param_nro_nc."P", "PARAMETROS_VEND_CIDADE", $volta_repre);

$usa_campo_vendedor_estado  = ValorClasse("NC".$param_nro_nc."P", "USA_CAMPO_VEND_ESTADO" , $volta_repre);
$parametros_vendedor_estado = ValorClasse("NC".$param_nro_nc."P", "PARAMETROS_VEND_ESTADO", $volta_repre);

if($acao == "Alterar" && (!$vez)) {
  if($campo_data_nasc == "SIM"){
    $campo_bd = ", data_nasc ";
  }
  if($usa_cpf == "A" || $usa_cpf == "S" || $usa_cpf == "J") {
    $campo_bd .= ", vendedor_cpf ";
  }

  if($usa_campo_cod_adabas == "S"){
    $campo_bd .= ", adabas ";
  }

  if($usa_campo_vendedor_cidade == "S"){
    $campo_bd.= ", vendedor_cidade ";
  }

  if($usa_campo_vendedor_estado == "S"){
    $campo_bd.= ", vendedor_estado ";
  }

  $where_alt = " WHERE mk_numero='".$param_nro_nc."' AND vend_eps = '".$cod_eps_alterar."' and vend_login = '".$login_alterar."' ";
  $sql_alt = "SELECT vend_login ".$campo_bd." ,  vendedor_nome,vend_regional,vend_eps,vend_depto,vendedor_chefe,vendedor_ddd_tel,vendedor_num_tel,vendedor_ramal_tel,vendedor_ddd_tel_1,vendedor_num_tel_1,vendedor_ramal_tel_1,vendedor_email,vendedor_nome_resumido,vendedor_status FROM tb_vendedor ".$where_alt." ORDER BY vend_login";
  if($session["print_sql"] == "S"){
    print $sql_alt."<br>";
  }
  $conexaoGen->query($sql_alt);
  if ($conexaoGen->status === false) {
    print $conexaoGen->getDescRetorno();
    exit();
  }
  if ($conexaoGen->count > 0) {
    $vend_login                 = $conexaoGen->result["vend_login"];
    $vendedor_nome              = $conexaoGen->result["vendedor_nome"];
    $vendedor_nome_resumido     = $conexaoGen->result["vendedor_nome_resumido"];
    $vend_regional              = $conexaoGen->result["vend_regional"];
    $vend_eps                   = $conexaoGen->result["vend_eps"];
    $vend_depto                 = $conexaoGen->result["vend_depto"];
    $vendedor_chefe             = $conexaoGen->result["vendedor_chefe"];
    $vendedor_ddd_tel           = $conexaoGen->result["vendedor_ddd_tel"];
    $vendedor_num_tel           = $conexaoGen->result["vendedor_num_tel"];
    $vendedor_ramal_tel         = $conexaoGen->result["vendedor_ramal_tel"];
    $vendedor_ddd_tel_1         = $conexaoGen->result["vendedor_ddd_tel_1"];
    $vendedor_num_tel_1         = $conexaoGen->result["vendedor_num_tel_1"];
    $vendedor_ramal_tel_1       = $conexaoGen->result["vendedor_ramal_tel_1"];
    $vendedor_email             = $conexaoGen->result["vendedor_email"];
    $vendedor_status            = $conexaoGen->result["vendedor_status"];
    $vendedor_cpf               = $conexaoGen->result["vendedor_cpf"];
    $adabas                     = $conexaoGen->result["adabas"];
    $vendedor_cidade            = $conexaoGen->result["vendedor_cidade"];
    $vendedor_estado            = $conexaoGen->result["vendedor_estado"];
    if($conexaoGen->result["data_nasc"] && $conexaoGen->result["data_nasc"] != "1111-11-11"){
      $dia_nasc = substr($conexaoGen->result["data_nasc"],8,2);
      $mes_nasc = substr($conexaoGen->result["data_nasc"],5,2);
      $ano_nasc = substr($conexaoGen->result["data_nasc"],0,4);
    }
  }
}

//var_dump($adabas);

if($msg) {
  $msg1  .= "<table class=\"table\">\n";
  $msg1  .= "  <tr>\n";
  $msg1  .= "    <td nowrap align=\"center\"><font class=\"txtvermelho\">".$msg."</td>\n";
  $msg1  .= "  </tr>\n";
  $msg1  .= "</table>\n";
  $msg1  .= "<br>\n";
}
$voltar = "javascript:document.form_volta.submit();";
$titulo = $acao." Vendedor";

$titulo = $objTradutor->traduzir($titulo);

?>
<!doctype html>
<html>
<head>
<title><?print $session["sistema"];?></title>
<meta http-equiv="x-ua-compatible" content="IE=edge">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<?print IntergrAllHeader();?>
<script type="text/javascript" src="consistencia.js"></script>
<script language="javascript" type="text/javascript">
<!--
function EnviaForm(form)
{
  if(checa(form)) {
    document.inclui.target="";
    document.inclui.action="nc_vendedores_inclui_bd.php";
    document.inclui.submit();
  }
}


function EnviaForm2(form)
{
  if(checa(form)) {
    document.inclui.action="";
    document.inclui.ancora.value='usa';
    document.inclui.submit();
  }
}


function ValidaCPF(campo) {
  cpf = campo.value;
  DescLengthCPFCNPJ(campo, document.getElementById('tamCpfCnpj2'));
}

-->
</script>

<?if ($ancora){
  $ancora_creditos = "onload = window.location='#creditos'";
}?>

</head>
<body <?print $ancora_creditos?>>
<?
if((!$deonde) || $deonde == "") {
  print GerarCabecalho($voltar, $titulo, "", "");
}else{
  $tit  .= "<br>\n";
  $tit  .= "<table class=\"table\">\n";
  $tit  .= "  <tr>\n";
  $tit  .= "    <td nowrap align=\"center\"><font class=\"tit\">".$titulo."</td>\n";
  $tit  .= "  </tr>\n";
  $tit  .= "</table>\n";
  $tit  .= "<p>\n";
  print $tit;
}
?>
<div class="container">
  <div class="col-sm-6 div-center">
<?
// echo $repre;// = $volta_repre;
$permissao_distri = ValorClasse("EKOME",$vend_depto,$repre);
if  (($repre == 'PORTOSEGURO-P' && $permissao_distri != " -- ") || ($vend_depto == "99998" || substr($vend_depto, 0, 5) == "99999" || substr($vend_depto, 0, 6) == "I00054")) {

  if (!$vez){
    $q_cre = "SELECT bola_vez_creditos,ddd_distribuicao FROM tb_vendedor WHERE vend_login = '".addslashes($vend_login)."'";
    $conexaoGen->query($q_cre);
    if ($conexaoGen->status === true) {
      do{
        $str_ddd      = $conexaoGen->result["ddd_distribuicao"];
        $vend_credito = $conexaoGen->result["bola_vez_creditos"];
      }while($conexaoGen->getFetchAssoc());
    } else {
      print $msg = "<font class='txtvermelho'>CONTATE UM ANALISTA DA URANET - ERRO:Não foi possivel fazer select no vend_login - ".$conexaoGen->getDescRetorno()."</font>";
      exit;
    }
  }


  if ($combo_cont != "" && $combo_acao != "") {
    if ($combo_acao == "R" && $combo_cont != '0') {
      $result_creditos = ($vend_credito - $combo_cont);
      $vend_credito1 = $vend_credito." - <font class='txtvermelho2'>".$combo_cont."</font> = ".$result_creditos;
    }
    if ($combo_acao == "A" && $combo_cont != '0') {
      $result_creditos = ($vend_credito + $combo_cont);
      $vend_credito1 = $vend_credito." + <font class='txtazul3'>".$combo_cont."</font> = ".$result_creditos;
    }

  } else {
    $result_creditos = $vend_credito1;
  }


  if ($combo_acao_ddd == "A" && $combo_ddd != "") {
    if (strpos("**".$str_ddd,$combo_ddd) > '0')  {
      $msg_existe="<font class='txtvermelho2'><b>"."DDD ".$combo_ddd." já Está Sendo Atendido"."</b></font>";
    }else{
      if($str_ddd !=""){
        $str_ddd = $str_ddd.",".$combo_ddd;
      }else{
        $str_ddd = $combo_ddd;
      }
    }
  }


  if ($combo_acao_ddd == "R" && $combo_ddd != "") {
    $str_ddd = str_replace($combo_ddd.",","",$str_ddd);
    $str_ddd = str_replace(",".$combo_ddd,"",$str_ddd);
    $str_ddd = str_replace($combo_ddd,"",$str_ddd);
  }

  if ($str_ddd != ""){
    $str_ddd= rtrim($str_ddd);
    $arr_ddd = explode(",",$str_ddd);
  }else{
    $arr_ddd="";
  }

  if ($radio_tipo_credito == "ilimitado" ){
    $result_creditos = "99999";

  }

  if ($radio_tipo_credito == "decrescente" && $vend_credito == "99999"){
    $vend_credito = "0";
    $result_creditos = "0";

  }
  if($result_creditos == "" && $vend_credito == "0"){
    $result_creditos="0";
  }

}

$query_string2 = "vend_regional=".$vend_regional."&vend_eps=".$vend_eps."&vend_depto=".$vend_depto;
?>

<form name="form_volta" method="POST" action="nc_vendedores_manut.php?<?print str_replace("\'", "'", $QUERY_STRING);?>">
<?
print $msg1;
$keys = array_keys($_POST);
for ($x = 0; $x < count((array)$keys); $x++) {
  $_POST[$keys[$x]] = str_replace("\'", "'", $_POST[$keys[$x]]);
  if (is_array($_POST[$keys[$x]])) {
    foreach ($_POST[$keys[$x]] as $key => $val) {

?>
  <input type="hidden" name="<?print $keys[$x];?>[]" value="<?print $val;?>">
<?
    }
  } else {
?>
  <input type="hidden" name="<?print $keys[$x];?>" value="<?print $_POST[$keys[$x]];?>">
<?
  }
}
?>
</form>
<form name="inclui" action="nc_vendedores_inclui.php" method="POST">
  <input type="hidden" name="acao"                   value="<?print $acao;                  ?>">
  <input type="hidden" name="procura"                value="<?print $procura;               ?>">
  <input type="hidden" name="deonde"                 value="<?print $deonde;                ?>">
  <input type="hidden" name="volta_status"           value="<?print $volta_status;          ?>">
  <input type="hidden" name="volta_repre"            value="<?print $volta_repre;           ?>">
  <input type="hidden" name="repre"                  value="<?print $repre;                 ?>">
  <input type="hidden" name="volta_cod_regional"     value="<?print $volta_cod_regional;    ?>">
  <input type="hidden" name="volta_cod_eps"          value="<?print $volta_cod_eps;         ?>">
  <input type="hidden" name="volta_cod_departamento" value="<?print $volta_cod_departamento;?>">
  <input type="hidden" name="volta_login"            value="<?print $volta_login;           ?>">
  <input type="hidden" name="empresa"                value="<?print $empresa;               ?>">
  <input type="hidden" name="equipe"                 value="<?print $equipe;                ?>">
  <input type="hidden" name="discador_modelo"        value="<?print $discador_modelo;       ?>">
  <input type="hidden" name="login_alterar"          value="<?print $login_alterar;         ?>">
  <input type="hidden" name="vend_login"             value="<?print $vend_login             ?>">
  <input type="hidden" name="cod_eps_alterar"        value="<?print $cod_eps_alterar        ?>">
  <input type="hidden" name="rel_where"              value="<?print str_replace("\'", "'", $rel_where);?>">
  <input type="hidden" name="result_creditos"        value="<?print $result_creditos;       ?>">
  <input type="hidden" name="vend_credito"           value="<?print $vend_credito;          ?>">
  <input type="hidden" name="str_ddd"                value="<?print $str_ddd;               ?>">
  <input type="hidden" name="ancora"                 value="">

<div class="panel panel-plain">
<table class="table">
<?

$titulo = explode("¢", ValorClasse("NC".$param_nro_nc."T", "1", $volta_repre));
if (!$manut_cod_eps) {
  if ($acao != "Alterar") {
    //    $vend_eps = $manut_cod_eps;
      ?>
        <tr>
          <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[1]?>:</strong></font></td>
          <td align="left" width="90%" nowrap>
            <select name="vend_eps" onChange="document.inclui.submit();" consistencia="sempre" consistencia1="pre" msg="Selecione um EPS">
              <?print MontaCombo("NC".$param_nro_nc."E", $vend_eps, $volta_repre);?>
            </select>
          </td>
        </tr>
      <?
  } else {
?>
  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[0];?>:</strong></font></td>
    <td align="left" width="90%" nowrap><font class="txt5"><?print ValorClasse("NC".$param_nro_nc."R", $vend_regional, $volta_repre)." (".$vend_regional.")";?></font></td>
    <input type="hidden" name="vend_regional" value="<?print $vend_regional;?>">
  </tr>


  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[1];?>:</strong></font></td>
    <td align="left" width="90%" nowrap><font class="txt5"><?print ValorClasse("NC".$param_nro_nc."E",$vend_eps,$volta_repre)." (".$vend_eps.")";?></font></td>
    <input type="hidden" name="vend_eps" value="<?print $vend_eps;?>">
  </tr>


<?
  }
} else {
  $vend_eps = $manut_cod_eps;

  if ($manut_vend_regional) {
    $vend_regional = $manut_vend_regional;
?>
  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[0];?>:</strong></font></td>
    <td align="left" width="90%" nowrap><font class="txt5"><?print ValorClasse("NC".$param_nro_nc."R", $vend_regional, $volta_repre)." (".$vend_regional.")";?></font></td>
    <input type="hidden" name="vend_regional" value="<?print $vend_regional;?>">
  </tr>
<?
  }
?>
  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[1];?>:</strong></font></td>
    <td align="left" width="90%" nowrap><font class="txt5"><?print ValorClasse("NC".$param_nro_nc."E", $vend_eps, $volta_repre)." (".$vend_eps.")";?></font></td>
    <input type="hidden" name="vend_eps" value="<?print $vend_eps;?>">
  </tr>
<?
}




//showvars();
if ($vend_eps) {
  $q = "SELECT representante, empresa, vend_regional, vend_depto, mk_numero FROM tb_canteiro WHERE mk_numero = '".addslashes($param_nro_nc)."' AND vend_eps = '".addslashes($vend_eps)."' AND status IN ('A','I') ";
  if ($session["print_sql"] == "S") {
    print $q."<br>";
  }
  $conexaoGen->query($q);
  if ($conexaoGen->status === false) {
    print $conexaoGen->getDescRetorno();
    exit();
  }
  if($conexaoGen->count > 0){
    $empresa       = $conexaoGen->result["empresa"];
    $repre         = $conexaoGen->result["representante"];
    $mk_numero     = $conexaoGen->result["mk_numero"];
    $vend_regional = $conexaoGen->result["vend_regional"];

?>
  <input type="hidden" name="repre"     value="<?print $_POST['repre'];?>">
  <input type="hidden" name="mk_numero" value="<?print $mk_numero;?>">
  <input type="hidden" name="empresa"   value="<?print $empresa;  ?>">
<?
if ($acao != "Alterar") {
  if (!$manut_vend_regional) {
?>
  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[0];?>:</strong></font></td>
    <td align="left" width="90%" nowrap><font class="txt5"><?print ValorClasse("NC".$param_nro_nc."R", $vend_regional, $volta_repre)." (".$vend_regional.")";?></font></td>
    <input type="hidden" name="vend_regional" value="<?print $vend_regional;?>">
  </tr>
<?
  }
}

if ((!$manut_vend_depto) && (($session["tp_user"] != "VDA"))) {

  if ($acao != "Alterar") {
          ?>
            <tr >
              <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[2];?>:</strong></font></td>
              <td align="left" width="90%" nowrap>
                <select name="vend_depto" consistencia="sempre" consistencia1="pre" msg="Selecione um Departamento">
          <?
          do {
          ?>
                  <option value="<?print $conexaoGen->result["vend_depto"];?>"<?
                  if ($conexaoGen->result["vend_depto"] == $vend_depto) {
                    print " selected";
                  }
                    ?>><?print ValorClasse("NC".$param_nro_nc."D", $conexaoGen->result["vend_depto"], $volta_repre)." (".$conexaoGen->result["vend_depto"].")";?></option>
                    <?
          } while ($conexaoGen->getFetchAssoc());
                    ?>

                </select>
              </td>
            </tr>
          <?
  } else {




    if ($session["tp_user"] == "CAN") {
        ?>
          <tr >
            <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[2];?>:</strong></font></td>
            <td align="left" width="90%" nowrap><font class="txt5"><?print ValorClasse("NC".$param_nro_nc."D", $vend_depto, $volta_repre)." (".$vend_depto.")";?></font></td>
          </tr>
          <input type="hidden" name="vend_depto" value="<?print $vend_depto;?>">
        <?
    } else {
        ?>
          <tr >
            <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[2];?>:</strong></font></td>
            <td align="left" width="90%" nowrap>
              <select name="vend_depto" consistencia="sempre" consistencia1="pre" msg="Selecione um Departamento">
        <?
        do {
        ?>
                <option value="<?print $conexaoGen->result["vend_depto"]?>"<?
                if ($conexaoGen->result["vend_depto"] == $vend_depto) {
                  print " selected";
                }
        ?>><?print ValorClasse("NC".$param_nro_nc."D", $conexaoGen->result["vend_depto"], $volta_repre)." (".$conexaoGen->result["vend_depto"].")";?></option>
        <?
        } while ($conexaoGen->getFetchAssoc());
        ?>
              </select>
            </td>
          </tr>
        <?
    }
  }
} else {
  if ($session["tp_user"] != "VDA") {
    $vend_depto = $manut_vend_depto;
  }
      ?>
      <tr >
        <td align="left" width="10%" nowrap><font class="txt5"><strong><?print $titulo[2];?>:</strong></font></td>
        <td align="left" width="90%" nowrap><font class="txt5"><?print ValorClasse("NC".$param_nro_nc."D", $vend_depto, $volta_repre)." (".$vend_depto.")";?></font></td>
      </tr>
      <input type="hidden" name="vend_depto" value="<?print $vend_depto;?>">
    <?
}
  }



  if ($acao == "Incluir") {
    //  $maxlength = 10 - strlen($vend_eps);


    if(ValorClasse("NC".substr($discador_modelo, 2, 2)."P", "AUTO_INCREMENT_VENDEDOR", DefineRepre($volta_repre)) == "SIM"){
      $desc_login = ValorClasse ("NC".$param_nro_nc."P", "DESC_VEND_LOGIN" , DefineRepre($volta_repre));
      $tamanho    = ValorClasse ("NC".$param_nro_nc."P", "TAMANHO_VEND_LOGIN" , DefineRepre($volta_repre));

      if($desc_login == "vend_depto") {
        $desc_login = $vend_depto;
        $desc_login_aux = "vend_depto";
      }

      if(!$desc_login || trim($desc_login) == "--"){
        print "Para AUTO_INCREMENT_VENDEDOR=SIM você também precisa cadastrar DESC_VEND_LOGIN na classe NC__P (O prefixo do vendedor)";
        exit;
      }

      $sql   = "SELECT MAX(vend_login) as login FROM tb_vendedor WHERE mk_numero='".addslashes($param_nro_nc)."' and vend_login like '".addslashes($desc_login)."%'";
      $conexaoGen->query($sql);
      if ($conexaoGen->status === false) {
        print $conexaoGen->getDescRetorno();
        exit();
      }

	  if($session["operador"] == "vivo00374xx") {
	    print "<li>MAX_LOGIN => ".$conexaoGen->result["login"];
	  }

      $r_lg  = $conexaoGen->result;

      if($r_lg["login"] != ""){
        $login_vend = $r_lg["login"];
      }

	  if($session["operador"] == "vivo00374XX") {
	    print "<li>LOGIN_VEND => ".$login_vend;
	    print "<li>DESC_LOGIN => ".$desc_login;
	  }

      if ($desc_login && $desc_login != "") {


        $login_vend = str_split($login_vend);

		if($session["operador"] == "vivo00374xx") {
		  print "<br>";
		  var_dump($login_vend);
		}

        foreach ($login_vend as $login_operador => $values){
          if (is_numeric($values)){
            $login_vende .= $values;
          }
        }

        if(!$tamanho || trim($tamanho) == "--"){
          $tamanho = 6;
        }

	    if($session["operador"] == "vivo00374xx") {
	      print "<li>LOGIN_VENDE => ".$login_vende;
	      print "<li>TAMANHO => ".$tamanho;
	    }


        $login_vende = $login_vende+1;

	    if($session["operador"] == "vivo00374xx") {
	      print "<li>LOGIN_VENDE + 1 => ".$login_vende;
	    }

        if($desc_login_aux == "vend_depto") {
          $vend_login_auto = str_pad($login_vende,$tamanho,0,STR_PAD_LEFT);
        } else {
          $vend_login_auto = $desc_login.str_pad($login_vende,$tamanho,0,STR_PAD_LEFT);
        }
        if ($vend_login_auto != $desc_login){
          $vend_login = $vend_login_auto;
        }

	    if($session["operador"] == "vivo00374xx") {
	      print "<li>vend_login + 1 => ".$vend_login;
	      print "<li>vend_login + 1 => ".$vend_login;
	    }

      }

        ?>
        <tr >
          <td align="left" width="10%" nowrap><font class="txt5"><strong>Cod. Vendedor:</strong></font></td>
           <td align="left" width="90%" nowrap>
            <input type="text" readonly maxlength="14" value="<?print $vend_login;?>" size="15" name="vend_login" consistencia="sempre" consistencia1="pre" consistencia2="simples" msg="Preencha corretamente o Código do Vendedor.">
          </td>
        </tr>
        <?
    }else{

      $maxlength = 14;
       ?>
       <tr >
         <td align="left" width="10%" nowrap><font class="txt5"><strong>Cod. Vendedor:</strong></font></td>
         <td align="left" width="90%" nowrap>
           <input type="text" maxlength="<?print $maxlength?>" value="<?print $vend_login;?>" size="15" name="vend_login" consistencia="sempre" consistencia1="pre" consistencia2="simples" msg="Preencha corretamente o Código do Vendedor.">
         </td>
       </tr>
       <?
    }
  } else {
    ?>
      <tr >
        <td align="left" width="10%" nowrap><font class="txt5"><strong>Cod. Vendedor:</strong></font></td>
        <td align="left" width="90%" nowrap><font class="txt5"><?print $vend_login;?>
        </font>
      </tr>
    <?
  }


  //var_dump($parametros_cod_adabas);
  //var_dump($usa_campo_cod_adabas);

  if ($usa_campo_cod_adabas == "S") {
    $parame_cod = explode("¢",$parametros_cod_adabas);
    if ($parame_cod[0] != ""){
      $desc_campo = $parame_cod[0].":";
    }else{
      $desc_campo = "Código ADABAS:";
    }

    if ($parame_cod[1] != ""){
      $max_campo = $parame_cod[1];
    }else{
      $max_campo = 4;
    }

    if ($parame_cod[2] != ""){
      $size_campo = $parame_cod[2];
    }else{
      $size_campo = 6;
    }
    if ($parame_cod[3] != ""){
      $tipo_dado = "todos";
    }else{
      $tipo_dado = "numeros";
    }

    ?>
    <tr>
       <td align="left"  nowrap><font class="txt5"><strong><?print $desc_campo?></strong></font></td>
       <td class="txt5">  <input name="adabas" id="adabas" maxlength="<?print $max_campo?>" size="<?print $size_campo?>" value="<?print $adabas?>"  consistir="sempre" msg="Preencha corretamente o campo <?print $desc_campo;?> - Obrigatório o preenchimento." tipodado="<?print $tipo_dado?>" minlength="4">
         <?
         if ($parame_cod[4] != ""){
           print "<font color='red'>".$parame_cod[4]."</font>";
         }
         ?>
       </td>
    </tr><?
  }

  if ($usa_campo_vendedor_estado == "S") {
    $parame_cod = explode("¢",$parametros_vendedor_estado);
    if ($parame_cod[0] != ""){
      $desc_campo = $parame_cod[0].":";
    }else{
      $desc_campo = "Estado Vendedor:";
    }

    if ($parame_cod[1] != ""){
      $max_campo = $parame_cod[1];
    }else{
      $max_campo = 4;
    }

    if ($parame_cod[2] != ""){
      $size_campo = $parame_cod[2];
    }else{
      $size_campo = 6;
    }
    if ($parame_cod[3] != ""){
      $tipo_dado = "todos";
    }else{
      $tipo_dado = "numeros";
    }

    ?>
    <tr>
       <td align="left"  nowrap><font class="txt5"><strong><?print $desc_campo?></strong></font></td>
       <td class="txt5">
          <select name="vendedor_estado"  id="vendedor_estado" consistir="sempre" msg="Preencha corretamente o campo <?print $desc_campo;?> - Obrigatório o preenchimento." tipodado="<?print $tipo_dado?>" minlength="2">
            <?print MontaCombo("URAUF",$vendedor_estado, $volta_repre);?>
          </select>
         <?
         if ($parame_cod[4] != ""){
           print "<font color='red'>".$parame_cod[4]."</font>";
         }
         ?>
       </td>
    </tr><?
  }

  if ($usa_campo_vendedor_cidade == "S") {
    $parame_cod = explode("¢",$parametros_vendedor_cidade);
    if ($parame_cod[0] != ""){
      $desc_campo = $parame_cod[0].":";
    }else{
      $desc_campo = "Cidade Vendedor:";
    }

    if ($parame_cod[1] != ""){
      $max_campo = $parame_cod[1];
    }else{
      $max_campo = 4;
    }

    if ($parame_cod[2] != ""){
      $size_campo = $parame_cod[2];
    }else{
      $size_campo = 6;
    }
    if ($parame_cod[3] != ""){
      $tipo_dado = "todos";
    }else{
      $tipo_dado = "numeros";
    }

    ?>
    <tr>
       <td align="left"  nowrap><font class="txt5"><strong><?print $desc_campo?></strong></font></td>
       <td class="txt5">
          <select name="vendedor_cidade"  id="vendedor_cidade" consistir="sempre" msg="Preencha corretamente o campo <?print $desc_campo;?> - Obrigatório o preenchimento." tipodado="<?print $tipo_dado?>" minlength="4">
            <?print MontaCombo("VPGCE", $vendedor_cidade, $volta_repre);?>
          </select>
         <?
         if ($parame_cod[4] != ""){
           print "<font color='red'>".$parame_cod[4]."</font>";
         }
         ?>
       </td>
    </tr><?
  }
  ?>
  <tr>
    <td align="left" width="10%" nowrap><font class="txt5"><strong><? print $objTradutor->traduzir("Nome Completo:") ?></strong></font></td>
    <td align="left" width="90%" nowrap>
      <input type ="text"  name="vendedor_nome" maxlength="80" value="<?print $vendedor_nome;?>"size="40" consistencia="sempre" consistencia1="pre"  consistencia2="todos" msg="Preencha corretamente o Nome">
    </td>
  </tr>
<?
if (((!$deonde) || ($deonde == "")) && ($acao != "Incluir")) {
?>
  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong><? print $objTradutor->traduzir("Nome Resumido:") ?></strong></font></td>
    <td align="left" width="90%" nowrap>
      <input type ="text"  name="vendedor_nome_resumido" maxlength="15" value="<?print $vendedor_nome_resumido;?>"size="16" consistencia="sempre" consistencia1="pre"  consistencia2="todos" msg="Preencha corretamente o Nome Resumido">
    </td>
  </tr>
<?
}
?>


<?if($campo_data_nasc == "SIM"){?>
  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong><? print $objTradutor->traduzir("Data Nascimento:"); ?></strong></font></td>
    <td align="left" width="90%" nowrap>
     <input type="text" maxlength="2" size="2" value="<?print $dia_nasc;?>" name="dia_nasc" consistir="sempre" tipodado="dia" msg="Preencha corretamente o Dia de Nascimento" onKeyUp="pula(this, 2, document.inclui.mes_nasc);" style="text-align: right;">/
     <input type="text" maxlength="2" size="2" value="<?print $mes_nasc;?>" name="mes_nasc" consistir="sempre" tipodado="mes" msg="Preencha corretamente o Mês de Nascimento" onKeyUp="pula(this, 2, document.inclui.ano_nasc);" style="text-align: right;">/
     <input type="text" maxlength="4" size="5" value="<?print $ano_nasc;?>" name="ano_nasc" consistir="sempre" tipodado="ano" msg="Preencha corretamente o Ano de Nascimento" style="text-align: right;">
  </td>
  </tr>
<?}?>


<?if($usa_cpf == "A" || $usa_cpf == "S" || $usa_cpf == "J") {?>
  <tr >
    <td align="left" width="10%" nowrap>
      <font class="txt5">
        <strong>
        <?
        switch ($usa_cpf) {
          case "S":
            $desc_cpf = "CPF";
            break;
          case "J":
            $desc_cpf = "CNPJ";
            break;
          default:
            $desc_cpf = "CPF/CNPJ";
            break;
        }
        print $desc_cpf.":";
        ?>
        </strong>
      </font>
    </td>
    <td align="left" width="90%" nowrap class="txt5">
      <input type ="text"  name="vendedor_cpf" maxlength="<?if($usa_cpf == "S") {?>11<?}else{?>14<?}?>" size="<?if($usa_cpf == "S") {?>13<?}else{?>18<?}?>" value="<?print $vendedor_cpf;?>" onkeyup="javascript: ValidaCPF(this);" consistir="sempre" tipodado="cpfcnpj" msg="Preencha corretamente o <?print $desc_cpf?>">
      <span id="tamCpfCnpj2" class="txt5" style="width: 35px; border: none; background: none; color: #DD0000;"></span>
    </td>
  </tr>
  <tr >
    <td colspan="2">
      <div id="id_vend_cpf"></div>
    </td>
  </tr>
<?}?>

<?if($repre != "ES-VITALDENT"){?>
  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong>Contato WhatsApp </strong></font></td>
    <td align="left" width="90%" nowrap>
      <input type ="text" name="vendedor_ddd_tel" maxlength="2" size ="3"  onKeyUp="pula(this,2,vendedor_num_tel);"    value="<?print $vendedor_ddd_tel;?>" consistencia="sopreenchido" consistencia1="ddd"  consistencia2="numeros" msg="Preencha corretamente o DDD">
      <input type ="text" name="vendedor_num_tel"  value="<?print $vendedor_num_tel;?>" msg="Preencha corretamente o Telefone">
      <img src="/callcenter/imagens/ico_hw.png" title="Número de WhatsApp" style="cursor: default;" width="16" height="16">
      <!-- <font class="txt5"><strong> - Ramal:</strong></font>
      <input type ="text" name="vendedor_ramal_tel" maxlength="4" size ="5" onKeyUp="pula(this,4,vendedor_ddd_tel_1);" value="<?print $vendedor_ramal_tel;?>" consistencia="sopreenchido" consistencia1="pre"  consistencia2="numeros" msg="Preencha corretamente o Ramal"> -->
    </td>
  </tr>
  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong>Fone Contato(2):</strong></font></td>
    <td align="left" width="90%" nowrap>
      <input type ="text"  name="vendedor_ddd_tel_1" maxlength="2" size ="3" onKeyUp="pula(this,2,vendedor_num_tel_1);"   value="<?print $vendedor_ddd_tel_1;?>" consistencia="sopreenchido" consistencia1="ddd"  consistencia2="numeros" msg="Preencha corretamente o DDD">
      <input type ="text"  name="vendedor_num_tel_1" maxlength="10" size ="11" onKeyUp="pula(this,10,vendedor_ramal_tel_1);" value="<?print $vendedor_num_tel_1;?>" consistencia="sopreenchido" consistencia1="telefone"  consistencia2="numeros" msg="Preencha corretamente o Telefone">
      <font class="txt5"><strong> - Ramal:</strong></font>
      <input type ="text" name="vendedor_ramal_tel_1" maxlength="4" size ="5" value="<?print $vendedor_ramal_tel_1;?>" consistencia="sopreenchido" consistencia1="pre"  consistencia2="numeros" msg="Preencha corretamente o Ramal">
    </td>
  </tr>

<?
}

$consist = "sopreenchido";
if($repre != "ES-VITALDENT"){?>
  <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong>E-mail:</strong></font></td>
    <td align="left" width="90%" nowrap>
      <input type ="text"  name="vendedor_email" maxlength="80" value="<?print $vendedor_email;?>"size="40" consistencia="<?print $consist ?>" consistencia1="pre"  consistencia2="email" msg="Preencha corretamente o Email">
    </td>
  </tr>

  <tr>
    <td align="left" width="10%" nowrap><font class="txt5"><strong>Nome do Chefe:</strong></font></td>
    <td align="left" width="90%" nowrap>
      <input type ="text"  name="vendedor_chefe" maxlength="80" value="<?print $vendedor_chefe;?>"size="40" consistencia="sopreenchido" consistencia1="pre"  consistencia2="letras" msg="Preencha corretamente o Nome Chefe">
    </td>
  </tr>
<?}?>
<? if (( ($vend_depto == "99998" || substr($vend_depto, 0, 5) == "99999" || substr($vend_depto, 0, 6) == "I00054") || ($repre == 'PORTOSEGURO-P' && $permissao_distri != " -- ")) && ($acao == "Incluir") ){?>
   <tr >
    <td align="left"  nowrap><font class="txt5"><strong>Tipo Crédito:</strong></font></td>
    <td align="left"  nowrap class="txt5">
       <input type="radio" name="radio_tipo_credito" id="radio_ilimitado"   value="ilimitado" <?if ($repre == 'PORTOSEGURO-P') { print ' checked ' ;}?> onclick="javascript:document.inclui.submit()" style="vertical-align: middle;"><label >Ilimitado</label>
      <?if ($repre != 'PORTOSEGURO-P') { ?> <input type="radio" name="radio_tipo_credito" id="radio_decrescente" value="decrescente" <?if ($radio_tipo_credito == 'decrescente' || $radio_tipo_credito =="" ) { print ' checked ' ; }?> onclick="javascript:document.inclui.submit(); " style="vertical-align: middle;"><label >Decrescente</label> <? } ?>
     </td>
   </tr>
  <?if (($radio_tipo_credito == "decrescente" || $radio_tipo_credito =="") && $repre != 'PORTOSEGURO-P'){?>
   <tr >
    <td align="left" width="10%" nowrap><font class="txt5"><strong>Créditos:</strong></font></td>
    <td align="left" width="90%" nowrap>
      <select name="combo_cont_inclui"  consistencia="sempre"  consistencia1="pre" msg="Preencha corretamente Número de Créditos" >
        <?for ($i = 0 ; $i <= 99 ; $i++) {?>
           <option value="<?print $i?>" <?if ($combo_cont_inclui == $i) { print "selected";}?> ><?print $i?></option>
        <?}?>
       </select>
    </td>
   </tr>
 <?}?>
<?}?>

<?
if($_REQUEST['repre']){
  $repre = $_REQUEST['repre'];
}else{
  $repre = $_REQUEST['volta_repre'];
}
?>

<?
if (((!$deonde) || ($deonde == "")) && ($acao != "Incluir")) {
?>
  <tr >
<?
if (!$vendedor_status) {
  $vendedor_status = "A";
}
?>
    <td align="left" width="10%" nowrap><font class="txt5"><strong><? print $objTradutor->traduzir("Situação"); ?>:</strong></font></td>
    <td align="left" width="90%" nowrap>
      <input type ="radio"  name="vendedor_status" value="A" <?if($vendedor_status == "A") { print " Checked";}?>><font class="txt5"><b> <? print $objTradutor->traduzir("Ativo"); ?>   </b></font>
      <input type ="radio"  name="vendedor_status" value="S" <?if($vendedor_status == "S") { print " Checked";}?>><font class="txt5"><b> <? print $objTradutor->traduzir("Suspenso"); ?></b></font>

    </td>
  </tr>
<?
}

?>







</table> <br><br>


<?
if (((!$deonde) || ($deonde == "")) ) {
?>
  <? if ( ( ($vend_depto == "99998" || substr($vend_depto, 0, 5) == "99999" || substr($vend_depto, 0, 6) == "I00054") ) || ($repre == 'PORTOSEGURO-P' && $permissao_distri != " -- ") && ($acao != "Incluir") ) {?>

    <center><?print $msg_existe;?> </center><br>
     <table class="table">
        <tr class='primary white'>
          <td class="text-center" colspan="2"><label>Créditos - Distribuição por E-mail<label></td>
        </tr>


         <tr >
          <td><label>Tipo Crédito:</label></td>
          <td>
             <input type="radio" name="radio_tipo_credito" id="radio_ilimitado"   value="ilimitado" <?if ($radio_tipo_credito == 'ilimitado' || $vend_credito == "99999") { print ' checked ' ;}?> onclick="document.inclui.ancora.value='usa';javascript:document.inclui.submit();" style="vertical-align: middle;"><label >Ilimitado</label>
             <input type="radio" name="radio_tipo_credito" id="radio_decrescente" value="decrescente" <?if (($radio_tipo_credito == "" && $vend_credito !="99999") || $radio_tipo_credito == "decrescente")   { print ' checked ' ; }?> onclick="document.inclui.ancora.value='usa';javascript:document.inclui.submit();" style="vertical-align: middle;"><label >Decrescente</label>
          </td>
         </tr>
        <tr >
          <td align="left" width="40%" nowrap><font class="txt5"><strong>Total de Créditos:</strong></font></td>

          <td align="left" width="60%" nowrap >
        <?if ($vend_credito != "99999"  && $radio_tipo_credito != "ilimitado" ){?>
            <?$msg_zero= "Créditos Esgotados";?>
              <font class="txt5"><b>
              <?if (!$combo_cont && $vend_credito != '0'){
                print $vend_credito;
              }
              if ($combo_cont){
                if ($acao == "Incluir") {
                  print $combo_cont;
                }else{
                  print $vend_credito1;
                }
              }

              if ($vend_credito =='0' && (!$combo_cont)) {
                print "<div class='alert alert-error text-center' style='margin-bottom: 0px;padding: 5px;'><label class='gap-bottom0'>".$msg_zero."</label></div>";
              }
        }else{
          print "<div class=alert alert-error><label>Ilimitado</label></div>";
        }
               ?>

           </td>
        </tr>

         <?if ($combo_acao) {
           $credito_colspan = "";
         }else{
           $credito_colspan = " colspan='2' ";
           }?>

      <?if (($radio_tipo_credito == "" && $vend_credito !="99999") || $radio_tipo_credito == "decrescente") {?>

        <tr >
         <td <?print $credito_colspan?> >
           <font class="txt5"><b>Ações:</b></font>
           <select name="combo_acao"  consistencia="sopreenchido" onchange="javascript: if (document.inclui.combo_cont) {document.inclui.combo_cont.value='';}  if (document.inclui.combo_ddd) {document.inclui.combo_ddd.value='';} document.inclui.ancora.value='usa';javascript:document.inclui.submit();" consistencia1="pre" msg="Preencha corretamente Ação">
             <option value="">-- Selecione --</option>
             <option value="A" <? if ($combo_acao == "A") { print " selected"; } ?> >Adicionar</option>
             <option value="R" <? if ($combo_acao == "R") { print " selected"; }?> >Remover</option>
           </select>
         </td>



        <?  if ($combo_acao == "R" || $combo_acao == "A") { ?>
             <td align="left"  nowrap>

              <font class="txt5"><b>Créditos:</b></font>
              <select name="combo_cont"  consistencia="sempre" onchange="javascript: if (document.inclui.combo_ddd){document.inclui.combo_ddd.value='';}  document.inclui.ancora.value='usa';javascript:document.inclui.submit();" consistencia1="pre" msg="Preencha corretamente Número de Créditos" >
               <?if ( $combo_acao == "R" ) {
                   for ($i = 0 ; $i <= $vend_credito ; $i++) {?>
                     <option value="<?print $i?>" <?if ($combo_cont  == $i) { print "selected";}?> ><?print $i?></option>
                 <?}?>
              </select>
               <?}?>
              <?if ( $combo_acao == "A" ) {
                  for ($i = 0 ; $i <= 99 ; $i++) {?>
                    <option value="<?print $i?>" <?if ($combo_cont == $i) { print "selected";}?> ><?print $i?></option>
                <?}
                }?>
              </td>
          <? }?>


       </tr>

 <?}?>

<? if(substr($repre, 0, 11) == 'PORTOSEGURO' && substr($vend_depto, 0, 6) != "I00054"){ ?>

     <tr class='primary white'>
       <td colspan="2" class="text-center" align="left"><b>Área Atuante</b></td>
     </tr>
  <?
  // if para contemplar campo de area atuante por CEP (Porto Seguro PMO)
  if($param_nro_nc == 'OM' && $repre == 'PORTOSEGURO-P'){
    $label_combo_ddd = "Região:";
    $classe_combo_ddd = "EK".substr($discador_modelo, 2, 2)."Z";
    $exibicao_combo_ddd = "descricao";
  } else {
    $label_combo_ddd = "DDD:";
    $classe_combo_ddd = "ADDDD";
    $exibicao_combo_ddd = "valor-descricao";
  }

  ?>
      <?if (is_array($arr_ddd)) {
          foreach ($arr_ddd as $chave => $valor) {?>
           <?//print "<li>".$valor?>
            <tr>
              <td colspan="2"><font class="txt5"><b><?print ValorClasse($classe_combo_ddd,$valor,$_REQUEST['repre'])?></font></b></td>
            </tr>
        <?}

      }else{?>
       <tr>
         <td colspan="2"><font class="txtvermelho2"><b>Nenhum Registro Encontrado<b></font></td>
       </tr>
    <?}?>

      <?if ($combo_acao_ddd) {
        $ddd_colspan = "";
      }else{
        $ddd_colspan = " colspan='2' ";
        }?>


          <tr >
             <td <?print $ddd_colspan?> >
               <font class="txt5"><b>Ações:</b></font>
               <select name="combo_acao_ddd"  consistencia="sopreenchido" onchange="javascript: if (document.inclui.combo_ddd) {document.inclui.combo_ddd.value='';} document.inclui.ancora.value='usa';javascript:document.inclui.submit();" consistencia1="pre" msg="Preencha corretamente Ação">
                 <option value="">-- Selecione --</option>
                 <option value="A" <? if ($combo_acao_ddd == "A") { print " selected"; }?> >Adicionar</option>
                 <option value="R" <? if ($combo_acao_ddd == "R") { print " selected"; }?> >Remover</option>
               </select>
             </td>

           <?if ($combo_acao_ddd == "A") {?>
               <td nowrap>
                 <font class="txt5"><b><? print $label_combo_ddd; ?></b></font>
                 <select name="combo_ddd"    consistencia1="pre" msg="Preencha corretamente o DDD">
                  <?print MontaCombo($classe_combo_ddd,$combo_ddd,$_REQUEST['repre'],"","",$exibicao_combo_ddd)?>
                 </select>&nbsp;

                 <input type="button" name="incluir" value="OK"   onclick="javascript: EnviaForm2(inclui);" class="but_proc_on" style="width: 30px" >
               </td>
           <?}?>


           <?if ($combo_acao_ddd == "R") {?>
               <td nowrap>
                 <font class="txt5"><b><? print $label_combo_ddd; ?></b></font>
                 <select name="combo_ddd"    consistencia1="pre" msg="Preencha corretamente o DDD">
                   <option value="">-- Selecione --</option>
                  <?foreach ($arr_ddd as $chave1 => $valor1) {?>
                      <option value= <?print $valor1?> <?if ($valor1 == $combo_ddd){print " selected";}?> ><?print $valor1." - ".ValorClasse($classe_combo_ddd,$valor1,$_REQUEST['repre'])?></option>
                  <?}?>
                 </select>&nbsp;
                    <input type="button" name="incluir2" value="OK"   onclick="javascript: EnviaForm2(inclui);" class="but_proc_on" style="width: 30px" >
               </td>
           <?}?>
       <?}?>

<? } ?>
 </table>

</div>
<?
}
$vez = "true";
$acao_tit = $objTradutor->traduzir($acao);
?>

<input type="hidden" name="vez"   value="<?print $vez;?>">
</form>
<a name="creditos"></a>
<div align="center"><button class="btn btn-primary" type="button" name="incluir" value="<?print " ".$acao." "; ?> " onclick="EnviaForm(inclui);" class="but_proc_on"><?print " ".$acao_tit." "; ?> </button></div>
  </div>
</div>
<?
}


if ((!$deonde) || $deonde == "") {
  print GerarRodape($voltar);
}
?>
</body>
</html>