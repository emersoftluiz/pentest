<?
session_start();
session_register("session");
$root = $_SERVER['DOCUMENT_ROOT']."/callcenter/";
set_include_path($root);
require_once "cc_libcallcenter.php";
if (!isset($session)) {header ("Location:".HTTPHOST.DOCROOT."cc_login.php"); exit;}

//showvars();
//exit;

ini_set("memory_limit","500M");
ini_set("upload_max_filesize","128M");

require_once($_SERVER['DOCUMENT_ROOT']."/libs/cli/TelefExportacaoLOG.php");
$objLogExport  = new ExportacaoLOG("MDIF");
if(strtoupper($tipo) == "EXCEL") {
  $tipo_log = "E";
  $tabelao_rel = str_replace("&nbsp;","",$tabelao_rel);  
} else {
  $tipo_log = "I";	
}	
$matriz_insLog["titulo"                ] = $titulo;
$matriz_insLog["nome_arq"              ] = $nome_arq;
$matriz_insLog["arq_dados"             ] = $arq_dados;
$matriz_insLog["aux_nome_arquivo"      ] = $aux_nome_arquivo;
$matriz_insLog["tabelao_rel"           ] = urldecode($tabelao_rel);
$matriz_insLog["tabelao_titulo"        ] = $tabelao_titulo;
$matriz_insLog["tipo"                  ] = $tipo;
$matriz_insLog["programa"              ] = $_SERVER["PHP_SELF"];

$objLogExport->InsertLogExportacao($matriz_insLog,$tipo_log);  

if(strtoupper($tipo) == "EXCEL") {

  header("Expires: 0");
  header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
  header("Content-type: application/vnd.ms-excel");

  if($nome_arquivo) {
    header('Content-Disposition: attachment; filename="'.$nome_arquivo.'"');
  } else {
//    header("Content-Disposition: attachment; filename=\"".$tabelao_titulo."\"");
    header('Content-Disposition: attachment; filename="imprime.xls"');
  }
  //  header("Content-Type: application/force-download");
  //  header("Content-Type: application/octet-stream");
  //  header("Content-Type: application/download");
  //  header("Content-Description: File Transfer");
  //  header("Content-Length: ".filesize(str_replace("my_border_color", "0", urldecode($tabelao_rel))));

  //  flush();
}

if(strtoupper($tipo) == "PDF") {
  //  header("Content-type: application/pdf");
  //  header("Content-Disposition: inline; filename=test.pdf");
  header('Content-Type: application/pdf');
  header('Content-Disposition: attachment; filename=file.pdf');
}


?>
<html>
  <head>
    <title>IntergrAll - Contact Center</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <style type="text/css">
      <!--
      input          {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #000000; text-decoration: none; border-color: #CCCCFF #CCCCFF #EEEEFF #EEEEFF; clear: none; float: none}
      select         {font-family: Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #000000; text-decoration: none; border-color: #CCCCFF #CCCCFF #EEEEFF #EEEEFF; clear: none; float: none }
      textarea       {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #000000; text-decoration: none; border-color: #CCCCFF #CCCCFF #EEEEFF #EEEEFF; clear: none; float: none}
      .input_alterado  {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #FFFFFF; text-decoration: none; border-color: #CCCCFF #CCCCFF #EEEEFF #EEEEFF; clear: none; float: none; background=#BB0000;}
      .select_alterado {font-family: Arial, Helvetica, sans-serif;          font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #FFFFFF; text-decoration: none; border-color: #CCCCFF #CCCCFF #EEEEFF #EEEEFF; clear: none; float: none; background=#BB0000;}

      a:link         {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #000000; text-decoration: none}
      a:visited      {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #000000; text-decoration: none}
      a:active       {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #2222FF; text-decoration: underline}
      a:hover        {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #2222FF; text-decoration: underline}

      .table         {border:1px solid #000000; cellpadding:0px; cellspacing:0; width: 95%; margin-top: 2px; margin-right: 2px; margin-bottom: 2px; margin-left: 2px; }
      .td            {border-color:#ddddff #103984 #103984 #ddddff; border-style: solid; border-width: 1px;}
      body            {background-attachment: fixed; background-color: #ffffff ; background-image: url(backg.jpg); background-repeat: no-repeat; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; background-position: right bottom}
      .bodylogin      {background-attachment: fixed; background-color: #ffffff; background-repeat: no-repeat; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; background-position: right bottom}
      .bodyprint      {background-attachment: fixed; background-color: #ffffff; background-repeat: no-repeat; margin-top: 50px; margin-right: 50px; margin-bottom: 50px; margin-left: 50px; background-position: right bottom}


      .txt12b {  font-family: Tahoma; font-size: 12px; font-weight: bold; text-decoration: none}
      .marginGrey {  border: 2px #A2B5CD solid}

      .fontevermelha {font-family: Verdana; font-size: 7pt; font-style: normal; font-weight: normal; color: #FF0000;}
      .fonteazul     {font-family: Verdana; font-size: 7pt; font-style: normal; font-weight: normal; color: #0000FF;}
      .fontelaranja  {font-family: Verdana; font-size: 7pt; font-style: normal; font-weight: normal; color: #FF8800;}
      .tit           {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #103984;}
      .titvermelho   {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 18; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #FF0000;}
      .txt           {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #000000;}
      .txt8          {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #000000;}
      .txtrosa       {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #FF69B4;}
      .txtvermelho   {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #FF0000;}
      .txtvermelho2  {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #FF0000;}
      .txtverde      {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #2E8B57;}
      .txtamarelo    {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #FFA500}
      .txtlaranja    {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #8B7D7B;}
      .txtazul       {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold;   font-variant: normal; text-transform: none; color: #0000FF;}
      .txtazul2      {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #103984;}
      .txtazul3      {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #2060ff;}
      .txt1          {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #000000;}
      .txt1prop      {font-family: Courier New, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #000000;}
      .txt2          {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #FFFFFF;}
      .txt5          {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #000000;}
      .txt5brancob   {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold  ; font-variant: normal; text-transform: none; color: #FFFFFF;}
      .txt5branco    {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #FFFFFF;}
      .txt5azul      {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #0000FF;}
      .txt5verde     {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #00AA00;}
      .txtvermelho3  {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #FF0000;}
      .txt6          {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #ffffff;}
      .botao         {font-family: Verdana; font-size: 7pt; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #333399; text-decoration: none; border-color: #CCCCFF #CCCCFF #CCCCFF #CCCCFF; clear: none; float: none}
      .titcol        {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #ffffff;}
      .titcolpeq     {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 7pt; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #ffffff;}
      .peq           {font-family: Verdana,Helvetica,Tahoma,Arial; font-size: 7pt; font-style: normal; font-weight: normal; color: #000000;}
      .peqbranca     {font-family: Arial,Helvetica,Tahoma,Verdana; font-size: 7pt; font-style: normal; font-weight: normal; color: #ffffff;}
      .brancapeq     {font-family: Arial,Helvetica,Tahoma,Verdana; font-size: 8pt; font-style: normal; font-weight: bold;   color: #ffffff;}
      .txt7          {font-family: Times,Helvetica,Tahoma,Verdana; font-size: 10pt; font-style: normal; font-weight: normal;   color: #000000;}

      .titcol:link   {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #ffffff;}
      .titcol:visited{font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #ffffff;}
      .titcol:hover  {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #ffffff;}

      .branco:link   {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #ffffff;}
      .branco:visited{font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #ffffff;}
      .branco:hover  {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #ffffff;}

      .vermelha:link   {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #FF0000;}
      .vermelha:visited{font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #FF0000;}
      .vermelha:hover  {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #FF0000;}

      .verde:link   {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #2E8B57;}
      .verde:visited{font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #2E8B57;}
      .verde:hover  {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #2E8B57;}

      .linkazul:link   {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #103984;}
      .linkazul:visited{font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #103984;}
      .linkazul:hover  {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #103984;}

      .titmenu:link   {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #000000;}
      .titmenu:visited{font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #000000;}
      .titmenu:hover  {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12; font-style: normal; line-height: normal; font-weight: bold; font-variant: normal; text-transform: none; color: #000088;}

      .butprod    {font-size: 9; HEIGHT:18px; WIDTH:21px; background=none;}
      .butprodsel {font-size: 9; HEIGHT:18px; WIDTH:21px; background=#ffaaaa;}

      .butativo   {font-family: Verdana, Arial, Helvetica, sans-serif; text-align: center; font-size: 12; font-weight: bold; border=none; background=none; color:#FFFFFF;}
      .butsuspenso{font-family: Verdana, Arial, Helvetica, sans-serif; text-align: center; font-size: 12; font-weight: bold; border=none; background=#FFAAAA; color:#000000;}

      .but_proc_on  {font-size: 10; font-weight: bold; color: #FFFFFF; WIDTH:100px; background=#103984;}
      .but_hide     {font-size: 10; font-weight: bold; color: #000000; WIDTH:170;   border=0; text-align= left; background=none;}
      .but_hide_2   {font-size: 10; font-weight: bold; color: #000000;              border=0; text-align= left; background=none;}
      .but_hide_off {font-size: 10; font-weight: bold; color: #000000; WIDTH:170;   text-align= left; background=#aaaaaa; border-color:  #888888 #eeeeee #eeeeee #888888 ;}
      .but_liga_on  {font-size: 10; font-weight: bold; color: #000000; WIDTH:100px; background=none;}
      .but_liga_off {font-size: 10; font-weight: bold; color: #ffffff; WIDTH:100px; background=#aaaaaa; border-color:  #888888 #eeeeee #eeeeee #888888 ;}

      .qdtesel    {HEIGHT:18px; WIDTH:20px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; color: #000000; background=#AAFFAA; border-color: #AAFFAA #AAFFAA #AAFFAA #AAFFAA;}
      .qdte       {HEIGHT:18px; WIDTH:20px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; color: #000000;}
      .tbsel      {bgcolor: #AAFFAA}

      .desativado {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10; font-style: normal; line-height: normal; font-weight: normal; font-variant: normal; text-transform: none; color: #000000; text-decoration: none; border-color: #CCCCFF #CCCCFF #EEEEFF #EEEEFF; clear: none; float: none; background=#cccccc;}
      -->
    </style>
    <script language="javascript" type="text/javascript" src="consistencia.js"></script>
  </head>
  <body style="background: 'none';" <?if(strtoupper($tipo) == "IMPRIME"){?> OnLoad="javascript:window.focus();window.print();" class="bodyprint"<?}?>>
    <?
      print str_replace("estilo", "style", urldecode($tabelao_titulo));

      if(strtoupper($rel_telef) == "S") {
        $tabelao_rel = str_replace("width", "wxixdxtxh", urldecode($tabelao_rel));
        $tabelao_rel = str_replace("<DIV", "<dic", $tabelao_rel);
      }

      if(strtoupper($tipo) == "EXCEL") {
        $tabelao_rel = str_replace("my_border_color", "1", urldecode($tabelao_rel));
        print str_replace("estilo", "style", $tabelao_rel);
      } else {
        print str_replace("my_border_color", "0", urldecode($tabelao_rel));
      }
    ?>
  </body>
</html>